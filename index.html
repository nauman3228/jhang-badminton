<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>City Badminton Club | Jhang Ledger</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { font-family: 'Outfit', sans-serif; background-color: #f3f4f6; color: #1f2937; }
        .glass-card { background: white; border: 1px solid #e5e7eb; border-radius: 1.5rem; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05); }
        .input-light { background-color: #f9fafb; border: 1.5px solid #e5e7eb; color: #111827; }
        .admin-only { display: none; }
        #lastMonthBalance:disabled { cursor: not-allowed; background-color: #f1f5f9; border-radius: 8px; padding-left: 8px; }
        @media print { .no-print { display: none !important; } }
        .icon-svg { width: 20px; height: 20px; }
        
        /* Slider Styles */
        .slider-container { position: relative; overflow: hidden; border-radius: 1.5rem; height: 350px; background-color: #1e293b; }
        .slide { position: absolute; inset: 0; opacity: 0; transition: opacity 1s ease-in-out; }
        .slide.active { opacity: 1; }
        .slide img { width: 100%; height: 100%; object-fit: cover; filter: brightness(0.6); }
        .slide-overlay { position: absolute; inset: 0; background: linear-gradient(to top, rgba(0,0,0,0.8), transparent); display: flex; align-items: flex-end; padding: 2.5rem; color: white; }
    </style>
</head>
<body class="min-h-screen">

<div class="max-w-6xl mx-auto px-6 py-10">
    <header class="flex flex-col md:flex-row justify-between items-center mb-10 gap-6">
        <div>
            <h1 class="text-3xl font-bold tracking-tight text-slate-900">üè∏ <span class="text-blue-600">City Badminton Club</span></h1>
            <p class="text-slate-500 font-bold tracking-widest uppercase text-xs mt-1 text-center md:text-left">Jhang City ‚Ä¢ Public Ledger</p>
        </div>
        <div class="flex gap-3 no-print">
            <button id="adminBtn" onclick="toggleAdmin()" class="bg-white border border-slate-300 text-slate-700 px-5 py-2 rounded-xl font-bold hover:bg-slate-50 shadow-sm transition-all flex items-center gap-2">
                <span id="lockIcon">üîí</span> <span id="adminText">Admin Login</span>
            </button>
            <button onclick="window.print()" class="bg-slate-900 text-white px-5 py-2 rounded-xl font-semibold hover:bg-slate-800 shadow-lg">üñ®Ô∏è Print</button>
        </div>
    </header>

    <div class="slider-container mb-10 shadow-2xl no-print">
        <div class="slide active">
            <img src="https://images.pexels.com/photos/3660204/pexels-photo-3660204.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" alt="Shuttlecock">
            <div class="slide-overlay">
                <div>
                    <h2 class="text-3xl font-bold uppercase tracking-tight">The Spirit of Jhang</h2>
                    <p class="text-sm opacity-90">Where passion meets the court every single day.</p>
                </div>
            </div>
        </div>
        <div class="slide">
            <img src="https://images.pexels.com/photos/2202685/pexels-photo-2202685.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" alt="Badminton Action">
            <div class="slide-overlay">
                <div>
                    <h2 class="text-3xl font-bold uppercase tracking-tight">Unleash Your Power</h2>
                    <p class="text-sm opacity-90">Elevate your game with Jhang's elite players.</p>
                </div>
            </div>
        </div>
        <div class="slide">
            <img src="https://images.pexels.com/photos/11501235/pexels-photo-11501235.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" alt="Badminton Racket">
            <div class="slide-overlay">
                <div>
                    <h2 class="text-3xl font-bold uppercase tracking-tight">Full Accountability</h2>
                    <p class="text-sm opacity-90">Manage club funds with transparency and precision.</p>
                </div>
            </div>
        </div>
    </div>

    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5 mb-8">
        <div class="glass-card p-6 border-b-4 border-blue-500">
            <p class="text-xs font-bold text-slate-500 uppercase mb-2">Opening Balance</p>
            <input id="lastMonthBalance" type="number" onchange="updateOpening(this.value)" class="bg-transparent text-2xl font-bold w-full outline-none text-slate-800" disabled placeholder="0">
        </div>
        <div class="glass-card p-6 border-b-4 border-emerald-500">
            <p class="text-xs font-bold text-slate-500 uppercase mb-2 text-emerald-600">Total All-Time Inc</p>
            <h2 id="totalIncome" class="text-2xl font-bold text-emerald-600">0</h2>
        </div>
        <div class="glass-card p-6 border-b-4 border-rose-500">
            <p class="text-xs font-bold text-slate-500 uppercase mb-2 text-rose-600">Total All-Time Exp</p>
            <h2 id="totalExpense" class="text-2xl font-bold text-rose-600">0</h2>
        </div>
        <div class="glass-card p-6 bg-slate-900 border-none shadow-xl">
            <p class="text-xs font-bold text-slate-400 uppercase mb-2 text-white">Net Cash Balance</p>
            <h2 id="netBalance" class="text-2xl font-bold text-white">0</h2>
        </div>
    </div>

    <div class="glass-card p-6 mb-10 bg-white border-l-8 border-blue-600">
        <h3 class="font-bold text-lg text-slate-800 mb-6 uppercase text-xs tracking-widest">üìÖ Monthly Ledger</h3>
        <input type="month" id="viewMonth" onchange="renderAll()" class="bg-blue-50 text-blue-700 px-4 py-2 rounded-lg font-bold outline-none mb-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="bg-emerald-50 p-4 rounded-2xl border border-emerald-100">
                <p class="text-[10px] font-bold text-emerald-600 uppercase text-center sm:text-left">Monthly Collections</p>
                <p class="text-2xl font-bold text-emerald-700 text-center sm:text-left">Rs. <span id="monthlyIncome">0</span></p>
            </div>
            <div class="bg-rose-50 p-4 rounded-2xl border border-rose-100">
                <p class="text-[10px] font-bold text-rose-600 uppercase text-center sm:text-left">Monthly Spending</p>
                <p class="text-2xl font-bold text-rose-700 text-center sm:text-left">Rs. <span id="monthlyExpense">0</span></p>
            </div>
        </div>
    </div>

    <section class="admin-only glass-card p-6 mb-10 bg-slate-50 border-dashed border-2 border-slate-300">
        <h3 class="font-bold text-lg mb-4 flex items-center gap-2">‚öôÔ∏è Admin Settings</h3>
        <div class="flex flex-wrap gap-4 items-end">
            <div>
                <label class="text-[10px] font-bold text-slate-500 uppercase">Change Admin Password</label>
                <input id="newPass" type="password" placeholder="New Password" class="input-light block w-48 p-2 rounded-lg text-sm mt-1">
            </div>
            <button onclick="changePassword()" class="bg-slate-700 text-white px-4 py-2 rounded-lg text-sm font-bold hover:bg-slate-800">Update Password</button>
        </div>
    </section>

    <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 mb-12">
        <div class="lg:col-span-4">
            <section class="glass-card p-6 h-full">
                <h3 class="font-bold text-lg mb-4 border-b pb-2">üë§ Members</h3>
                <div class="admin-only flex gap-2 mb-4">
                    <input id="newMemberName" type="text" placeholder="Add Name" class="input-light px-3 py-2 rounded-lg w-full">
                    <button onclick="addMember()" class="bg-blue-600 text-white px-4 rounded-lg font-bold">+</button>
                </div>
                <div id="memberStatusList" class="space-y-2 max-h-80 overflow-y-auto"></div>
            </section>
        </div>
        <div class="lg:col-span-4">
            <section class="glass-card p-6 border-t-4 border-emerald-500 h-full">
                <h3 class="font-bold text-lg mb-4 text-emerald-600 border-b pb-2">üí∞ Income Log</h3>
                <div class="admin-only space-y-2 mb-4">
                    <input id="fundDate" type="date" class="input-light w-full p-2 rounded-lg text-sm">
                    <select id="fundMemberSelect" class="input-light w-full p-2 rounded-lg text-sm"></select>
                    <input id="fundAmount" type="number" placeholder="Amount" class="input-light w-full p-2 rounded-lg text-sm">
                    <button onclick="addFund()" class="w-full bg-emerald-600 text-white font-bold py-2 rounded-lg">Save</button>
                </div>
                <table class="w-full text-[11px]"><tbody id="fundHistory" class="divide-y"></tbody></table>
            </section>
        </div>
        <div class="lg:col-span-4">
            <section class="glass-card p-6 border-t-4 border-rose-500 h-full">
                <h3 class="font-bold text-lg mb-4 text-rose-600 border-b pb-2">üí∏ Expense Log</h3>
                <div class="admin-only space-y-2 mb-4">
                    <input id="expDate" type="date" class="input-light w-full p-2 rounded-lg text-sm">
                    <input id="expDetail" type="text" placeholder="Detail" class="input-light w-full p-2 rounded-lg text-sm">
                    <input id="expAmount" type="number" placeholder="Amount" class="input-light w-full p-2 rounded-lg text-sm">
                    <button onclick="addExpense()" class="w-full bg-rose-600 text-white font-bold py-2 rounded-lg">Save</button>
                </div>
                <table class="w-full text-[11px]"><tbody id="expenseHistory" class="divide-y"></tbody></table>
            </section>
        </div>
    </div>

    <section class="no-print glass-card p-8 bg-slate-100 mb-20">
        <h3 class="font-bold text-xl mb-8 text-center text-slate-700">üìú All-Time Archives</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div class="bg-white p-4 rounded-xl shadow-sm">
                <label class="text-[10px] font-bold text-blue-500 uppercase tracking-widest">Search Member Payments</label>
                <select id="historyMemberSelect" onchange="renderMemberHistory()" class="input-light w-full p-2 rounded-lg mt-1 mb-4"></select>
                <div id="memberHistoryResult" class="hidden text-sm max-h-60 overflow-y-auto"><table class="w-full"><tbody id="historyMemberTable" class="divide-y"></tbody></table></div>
            </div>
            <div class="bg-white p-4 rounded-xl shadow-sm">
                <label class="text-[10px] font-bold text-rose-500 uppercase tracking-widest">Search Expense Type</label>
                <select id="historyExpenseSelect" onchange="renderExpenseHistory()" class="input-light w-full p-2 rounded-lg mt-1 mb-4"></select>
                <div id="expenseHistoryResult" class="hidden text-sm max-h-60 overflow-y-auto"><table class="w-full"><tbody id="historyExpenseTable" class="divide-y"></tbody></table></div>
            </div>
        </div>
    </section>
</div>

<footer class="mt-20 border-t border-slate-200 bg-white py-16 no-print">
    <div class="max-w-6xl mx-auto px-6">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-12 text-center md:text-left">
            <div class="col-span-1">
                <h4 class="text-xl font-bold text-slate-900 mb-4 flex items-center justify-center md:justify-start gap-2">üè∏ City Badminton Club</h4>
                <p class="text-slate-500 text-sm leading-relaxed">Official digital management system for the Jhang Badminton community. Committed to transparency.</p>
            </div>
            <div class="col-span-1">
                <h4 class="font-bold text-slate-800 mb-4 uppercase text-xs tracking-widest border-b pb-2 inline-block">Contact Support</h4>
                <p class="text-slate-900 font-bold text-lg mb-1">üìû 0322-6251618</p>
                <p class="text-blue-600 font-medium text-sm">Admin: Nauman</p>
                <p class="text-slate-400 text-xs mt-2">Jhang City, Punjab, Pakistan</p>
            </div>
            <div class="col-span-1">
                <h4 class="font-bold text-slate-800 mb-4 uppercase text-xs tracking-widest border-b pb-2 inline-block">Social Media</h4>
                <div class="flex flex-col gap-3 items-center md:items-start">
                    <a href="https://youtube.com/@nauman_322?si=4g_lIm4ACYljmAor" target="_blank" class="flex items-center gap-3 text-slate-600 hover:text-rose-600 transition-colors group">
                        <svg class="icon-svg fill-current group-hover:text-rose-600" viewBox="0 0 24 24"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.246 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/></svg>
                        <span class="text-sm font-semibold">Our YouTube Channel</span>
                    </a>
                    <a href="https://wa.me/923226251618" target="_blank" class="flex items-center gap-3 text-slate-600 hover:text-emerald-600 transition-colors group">
                        <svg class="icon-svg fill-current group-hover:text-emerald-600" viewBox="0 0 24 24"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.438 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884 0 2.225.569 3.808 1.694 5.469l-.992 3.621 3.797-.989zm11.387-5.477c-.31-.156-1.834-.905-2.112-1.006-.277-.101-.48-.151-.681.151-.201.302-.779 1.006-.955 1.208-.176.201-.351.226-.662.071-.31-.156-1.311-.483-2.5-1.543-.923-.824-1.546-1.841-1.727-2.152-.181-.31-.019-.477.135-.631.139-.139.31-.362.466-.543.156-.181.208-.31.31-.518.101-.208.05-.389-.025-.543-.075-.154-.681-1.641-.933-2.247-.245-.589-.494-.509-.681-.518-.176-.008-.377-.01-.579-.01-.201 0-.528.075-.805.377-.277.302-1.056 1.031-1.056 2.516s1.081 2.919 1.232 3.12c.151.201 2.128 3.248 5.155 4.554.72.311 1.282.497 1.721.637.723.23 1.381.197 1.901.12.58-.086 1.834-.751 2.091-1.477.257-.725.257-1.346.181-1.477-.076-.131-.277-.208-.587-.364z"/></svg>
                        <span class="text-sm font-semibold">WhatsApp Support</span>
                    </a>
                </div>
            </div>
            <div class="col-span-1">
                <h4 class="font-bold text-slate-800 mb-4 uppercase text-xs tracking-widest border-b pb-2 inline-block">Location</h4>
                <p class="text-slate-600 text-sm">Jhang City, 35200<br>Punjab, Pakistan</p>
            </div>
        </div>
    </div>
</footer>

<script>
    // SLIDER LOGIC
    let currentSlide = 0;
    const slides = document.querySelectorAll('.slide');
    function nextSlide() {
        if (slides.length === 0) return;
        slides[currentSlide].classList.remove('active');
        currentSlide = (currentSlide + 1) % slides.length;
        slides[currentSlide].classList.add('active');
    }
    setInterval(nextSlide, 5000);

    // FIREBASE INITIALIZATION
    const firebaseConfig = { apiKey: "AIzaSyBRBq6D2ArZ-LlIyAfqU_Qjm8-SAmf0_q8", authDomain: "jhangbadminton.firebaseapp.com", projectId: "jhangbadminton", databaseURL: "https://jhangbadminton-default-rtdb.firebaseio.com", storageBucket: "jhangbadminton.firebasestorage.app", messagingSenderId: "845495083243", appId: "1:845495083243:web:523d6f8770d8129f491eae" };
    firebase.initializeApp(firebaseConfig);
    const dbRef = firebase.database().ref('clubData');
    let db = { openingBalance: 0, members: [], funds: [], expenses: [], adminPass: "1234" };
    let isAdmin = false;

    dbRef.on('value', (snapshot) => {
        const data = snapshot.val();
        if (data) { db = data; if(!db.members) db.members=[]; if(!db.funds) db.funds=[]; if(!db.expenses) db.expenses=[]; }
        renderAll();
    });

    function save() { dbRef.set(db); }

    function toggleAdmin() {
        if (!isAdmin) {
            const p = prompt("Enter Password:");
            if (p === db.adminPass) { isAdmin = true; updateUI(true); }
            else { alert("Wrong Password"); }
        } else {
            if (confirm("Logout?")) { isAdmin = false; updateUI(false); }
        }
    }

    function updateUI(log) {
        document.querySelectorAll('.admin-only').forEach(e => e.style.display = log ? 'block' : 'none');
        document.getElementById('lastMonthBalance').disabled = !log;
        document.getElementById('adminText').innerText = log ? "Logout" : "Admin Login";
        document.getElementById('lockIcon').innerText = log ? "üîì" : "üîí";
        renderAll();
    }

    function changePassword() {
        const n = document.getElementById('newPass').value;
        if(n.length >= 4) { db.adminPass = n; save(); alert("Password Changed!"); }
    }

    window.onload = () => { 
        document.getElementById('viewMonth').value = new Date().toISOString().substring(0, 7); 
        document.getElementById('fundDate').valueAsDate = new Date(); 
        document.getElementById('expDate').valueAsDate = new Date(); 
    };

    function addMember() { 
        const v = document.getElementById('newMemberName').value.trim(); 
        if(v){db.members.push(v); save(); document.getElementById('newMemberName').value="";}
    }

    function deleteMember(i) { if(confirm("Delete Member?")){db.members.splice(i,1); save();}}
    function editMember(i) { const n = prompt("New Name:", db.members[i]); if(n){db.members[i]=n; save();}}

    function addFund() { 
        const d = document.getElementById('fundDate').value, 
              n = document.getElementById('fundMemberSelect').value, 
              a = parseInt(document.getElementById('fundAmount').value); 
        if(d && n && a){ db.funds.unshift({d, n, a, id: Date.now()}); save(); document.getElementById('fundAmount').value=""; }
    }

    function editFund(id) { 
        const i = db.funds.find(f => f.id === id), 
              nD = prompt("Date:", i.d), 
              nA = prompt("Amount:", i.a); 
        if(nD && nA){ i.d = nD; i.a = parseInt(nA); save(); }
    }

    function deleteFund(id) { if(confirm("Delete Income Entry?")){ db.funds = db.funds.filter(f=>f.id!==id); save(); }}

    function addExpense() { 
        const d = document.getElementById('expDate').value, 
              det = document.getElementById('expDetail').value, 
              a = parseInt(document.getElementById('expAmount').value); 
        if(d && det && a){ db.expenses.unshift({d, det, a, id: Date.now()}); save(); document.getElementById('expDetail').value=""; document.getElementById('expAmount').value=""; }
    }

    function editExpense(id) { 
        const i = db.expenses.find(e => e.id === id), 
              nD = prompt("Date:", i.d), 
              nDet = prompt("Detail:", i.det), 
              nA = prompt("Amount:", i.a); 
        if(nD && nDet && nA){ i.d = nD; i.det = nDet; i.a = parseInt(nA); save(); }
    }

    function deleteExpense(id) { if(confirm("Delete Expense?")){ db.expenses = db.expenses.filter(e=>e.id!==id); save(); }}

    function updateOpening(v) { db.openingBalance = parseInt(v) || 0; save(); }

    function renderAll() {
        const m = document.getElementById('viewMonth').value;
        const tin = db.funds.reduce((s,f)=>s+f.a,0), tout = db.expenses.reduce((s,e)=>s+e.a,0);
        
        document.getElementById('totalIncome').innerText = tin.toLocaleString();
        document.getElementById('totalExpense').innerText = tout.toLocaleString();
        document.getElementById('netBalance').innerText = `Rs. ${(db.openingBalance + tin - tout).toLocaleString()}`;
        document.getElementById('lastMonthBalance').value = db.openingBalance;
        
        document.getElementById('monthlyIncome').innerText = db.funds.filter(f=>f.d.startsWith(m)).reduce((s,f)=>s+f.a,0).toLocaleString();
        document.getElementById('monthlyExpense').innerText = db.expenses.filter(e=>e.d.startsWith(m)).reduce((s,e)=>s+e.a,0).toLocaleString();
        
        const mDiv = document.getElementById('memberStatusList'), fs = document.getElementById('fundMemberSelect'), hs = document.getElementById('historyMemberSelect');
        mDiv.innerHTML = ""; fs.innerHTML = '<option value="">Member...</option>'; hs.innerHTML = '<option value="">Member...</option>';
        
        db.members.sort().forEach((name, i) => {
            const paid = db.funds.some(f => f.n === name && f.d.startsWith(m));
            mDiv.innerHTML += `<div class="flex justify-between items-center p-2 bg-slate-50 rounded-lg text-sm"><span>${name} ${paid ? '‚úÖ':''}</span><div class="admin-only" style="display:${isAdmin?'block':'none'}"><button onclick="editMember(${i})" class="text-blue-500 mr-2">‚úèÔ∏è</button><button onclick="deleteMember(${i})" class="text-rose-400">üóëÔ∏è</button></div></div>`;
            fs.innerHTML += `<option value="${name}">${name}</option>`; hs.innerHTML += `<option value="${name}">${name}</option>`;
        });
        
        document.getElementById('fundHistory').innerHTML = db.funds.filter(f=>f.d.startsWith(m)).map(f=>`<tr><td class="py-2">${f.d.slice(5)}</td><td>${f.n}</td><td class="text-emerald-600 font-bold">+${f.a}</td><td class="admin-only text-right" style="display:${isAdmin?'table-cell':'none'}"><button onclick="editFund(${f.id})" class="mr-1">‚úèÔ∏è</button><button onclick="deleteFund(${f.id})">üóëÔ∏è</button></td></tr>`).join('');
        document.getElementById('expenseHistory').innerHTML = db.expenses.filter(e=>e.d.startsWith(m)).map(e=>`<tr><td class="py-2">${e.d.slice(5)}</td><td>${e.det}</td><td class="text-rose-600 font-bold">-${e.a}</td><td class="admin-only text-right" style="display:${isAdmin?'table-cell':'none'}"><button onclick="editExpense(${e.id})" class="mr-1">‚úèÔ∏è</button><button onclick="deleteExpense(${e.id})">üóëÔ∏è</button></td></tr>`).join('');
        
        const es = document.getElementById('historyExpenseSelect'); es.innerHTML = '<option value="">Category...</option>';
        Array.from(new Set(db.expenses.map(e=>e.det))).forEach(d=>{es.innerHTML+=`<option value="${d}">${d}</option>`});
    }

    function renderMemberHistory() {
        const s = document.getElementById('historyMemberSelect').value; if(!s) return;
        const l = db.funds.filter(f=>f.n===s);
        document.getElementById('historyMemberTable').innerHTML = l.map(f=>`<tr><td>${f.d}</td><td class="text-right font-bold text-emerald-600">${f.a}</td></tr>`).join('');
        document.getElementById('memberHistoryResult').classList.remove('hidden');
    }

    function renderExpenseHistory() {
        const s = document.getElementById('historyExpenseSelect').value; if(!s) return;
        const l = db.expenses.filter(e=>e.det===s);
        document.getElementById('historyExpenseTable').innerHTML = l.map(e=>`<tr><td>${e.d}</td><td class="text-right font-bold text-rose-600">${e.a}</td></tr>`).join('');
        document.getElementById('expenseHistoryResult').classList.remove('hidden');
    }
</script>
</body>
</html>
